---
layout:     post
title:      IIS日志分析
subtitle:   win2003下IIS日志分析
date:       201-05-25
author:     Threekb
header-img: img/post-bg-coffee.jpeg
catalog: true
tags:
    - IIS
    - 日志分析
---

## IIS服务器日志分析
>在服务器收到攻击后非常重要的一个分析手段，通过分析网站的日志文件判断攻击者的手法和目的从而还原攻击者的恶意攻击
### 操作信息：
    分析目标：192.168.90.182
    分析时间：2019-05-25
    分析文件：C:/windows/system32/logfiles/ex160708.log

### 分析过程：
![](https://threekb-1259310634.cos.ap-beijing.myqcloud.com/blog/20190525205149.png)<br>
    IP: 192.168.90.136<br>
    时间:2016-07-08 06:16:04<br>
    行为:在6.15分管理员下线后192.168.90.136（下文称攻击者）访问了网站的首页<br>
![](https://threekb-1259310634.cos.ap-beijing.myqcloud.com/blog/20190525205229.png)<br>
    IP:192.168.90.136<br>
    时间:2016-07-08 06:16:33<br>
    行为:通过连续有规律的404信息判断攻击者从6:16:33 秒开始使用扫描器对网站进行扫描<br>
![](https://threekb-1259310634.cos.ap-beijing.myqcloud.com/blog/20190525205246.png)<br>
    IP:192.168.90.136<br>
    时间:2016-07-08 06:16:43<br>
    行为:攻击者于6:16:43秒停止了对网站后台的扫描，并尝试访问了/db/等一些页面<br>
![](https://threekb-1259310634.cos.ap-beijing.myqcloud.com/blog/20190525205305.png)<br>
    IP:192.168.90.136<br>
    时间:2016-07-08 06:17:48<br>
    行为:攻击者于6:17:48秒访问了网站的管理员后台登录页面，并与6:17:50开始尝试登陆后台，通过弱口令的方式与6:18:07成功登陆管理员后台页面<br>
![](https://threekb-1259310634.cos.ap-beijing.myqcloud.com/blog/20190525205305.png)<br>
    IP:192.168.90.136<br>
    时间:2016-07-08 06:19:30<br>
    行为:攻击者于6:19:30秒开始对数据库，网站日志等多个页面进行操作<br>
![](https://threekb-1259310634.cos.ap-beijing.myqcloud.com/blog/20190525205316.png)<br>
    IP:192.168.90.136<br>
    时间:2016-07-08 06:36:09<br>
    行为:攻击者于6:36:09秒开始删除了自己的部分操作记录并退出，于7:02:21秒又重新访问了管理员后台，于7:34:19秒又访问了网站<br>

### 分析结果：
    后台目录过于简单容易被扫描器识别
    管理员后台存在弱口令容易被猜解
    管理员后台没有对除管理员之外的其他IP做权限限制
    网站管理员没有定期备份日志的习惯 

### 解决方案：
    网站的目录名要尽量主观化，避免默认和容易被猜解的敏感目录名。
    管理员后台账号密码要设置成复杂的不易被猜解的密码。
    管理员后台禁止除管理员IP以外的IP访问，并对尝试登录次数做严格限制，或者使用短信验证等安全的方式验证管理员的登录方式。
    管理员要定期备份网站日志，以防日志被攻击者删除后没法追踪溯源。




